<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lesson Materials ¬∑ English Quest</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,800;1,700&family=IBM+Plex+Sans:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --purple: #7C3AED; --purple-light: #A78BFA; --purple-soft: #EDE9FE;
      --purple-mid: #C4B5FD; --white: #FFFFFF; --off-white: #F9F7FF;
      --text-dark: #1E1040; --text-muted: #6B5B95; --border: #E5DEFF;
      --accent: #F59E0B; --green: #10B981;
    }
    body { font-family: 'IBM Plex Sans', sans-serif; background: var(--off-white); color: var(--text-dark); min-height: 100vh; }

    /* HEADER */
    header {
      background: linear-gradient(135deg, #7C3AED 0%, #5B21B6 50%, #4C1D95 100%);
      padding: 36px 24px 52px; text-align: center; position: relative; overflow: hidden;
    }
    header::before {
      content: ''; position: absolute; inset: 0;
      background-image: radial-gradient(circle, rgba(255,255,255,0.08) 1px, transparent 1px);
      background-size: 28px 28px; pointer-events: none;
    }
    .back-btn {
      position: absolute; top: 20px; left: 20px; z-index: 2;
      background: rgba(255,255,255,0.15); border: 1.5px solid rgba(255,255,255,0.3);
      color: #fff; font-family: 'IBM Plex Sans', sans-serif; font-size: 0.88rem;
      font-weight: 600; padding: 8px 18px; border-radius: 999px; cursor: pointer;
      text-decoration: none; display: inline-flex; align-items: center; gap: 6px;
    }
    .back-btn:hover { background: rgba(255,255,255,0.25); }
    header h1 { font-family: 'Playfair Display', serif; font-size: clamp(1.8rem,5vw,2.8rem); font-weight: 800; color: #fff; position: relative; z-index: 1; }
    header h1 span { color: var(--accent); font-style: italic; }
    .header-sub { color: rgba(255,255,255,0.75); font-size: 0.95rem; margin-top: 8px; position: relative; z-index: 1; }
    .wave { display: block; width: 100%; margin-top: -2px; }

    /* MAIN */
    main { max-width: 900px; margin: 0 auto; padding: 32px 20px 80px; }

    /* CHAPTER SECTION */
    .chapter-section { margin-bottom: 48px; }
    .chapter-header {
      display: flex; align-items: center; gap: 14px; margin-bottom: 20px;
    }
    .chapter-badge {
      background: linear-gradient(135deg, var(--purple), #5B21B6);
      color: #fff; font-family: 'IBM Plex Mono', monospace; font-size: 0.78rem;
      font-weight: 600; padding: 6px 14px; border-radius: 999px; flex-shrink: 0;
      letter-spacing: 0.05em;
    }
    .chapter-title {
      font-family: 'Playfair Display', serif; font-size: 1.4rem; font-weight: 700;
    }
    .chapter-line { flex: 1; height: 1.5px; background: var(--border); }

    /* PDF CARDS GRID */
    .pdf-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; }

    .pdf-card {
      background: var(--white); border: 1.5px solid var(--border); border-radius: 20px;
      overflow: hidden; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer;
    }
    .pdf-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(124,58,237,0.12); }

    .pdf-preview {
      width: 100%; aspect-ratio: 4/3; background: var(--purple-soft);
      display: flex; align-items: center; justify-content: center;
      position: relative; overflow: hidden; border-bottom: 1.5px solid var(--border);
    }
    .pdf-preview iframe {
      width: 100%; height: 100%; border: none; pointer-events: none;
    }
    .pdf-icon {
      font-size: 3rem; position: absolute; opacity: 0.3;
    }
    .pdf-overlay {
      position: absolute; inset: 0; background: rgba(124,58,237,0.05);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; transition: opacity 0.2s;
    }
    .pdf-card:hover .pdf-overlay { opacity: 1; }
    .pdf-overlay-btn {
      background: var(--purple); color: #fff; font-size: 0.85rem; font-weight: 700;
      padding: 10px 20px; border-radius: 999px; font-family: 'IBM Plex Sans', sans-serif;
    }

    .pdf-info { padding: 16px 18px 18px; }
    .pdf-name { font-size: 1rem; font-weight: 700; margin-bottom: 4px; line-height: 1.3; }
    .pdf-meta { font-size: 0.78rem; color: var(--text-muted); font-family: 'IBM Plex Mono', monospace; margin-bottom: 14px; }
    .pdf-actions { display: flex; gap: 8px; }
    .btn-view {
      flex: 1; padding: 10px; background: var(--purple-soft); color: var(--purple);
      border: 1.5px solid var(--purple-mid); border-radius: 10px; font-size: 0.85rem;
      font-weight: 700; text-align: center; cursor: pointer; font-family: inherit;
      text-decoration: none; display: block; transition: background 0.15s;
    }
    .btn-view:hover { background: var(--purple-mid); }
    .btn-download {
      padding: 10px 14px; background: var(--purple); color: #fff;
      border: none; border-radius: 10px; font-size: 0.85rem; font-weight: 700;
      cursor: pointer; font-family: inherit; text-decoration: none;
      display: flex; align-items: center; gap: 5px; transition: opacity 0.15s;
    }
    .btn-download:hover { opacity: 0.85; }

    /* COMING SOON CARD */
    .coming-soon-card {
      background: var(--white); border: 1.5px dashed var(--border); border-radius: 20px;
      padding: 32px 24px; display: flex; align-items: center; gap: 20px;
    }
    .cs-icon {
      width: 56px; height: 56px; background: var(--off-white); border-radius: 16px;
      display: flex; align-items: center; justify-content: center; font-size: 1.6rem;
      flex-shrink: 0; border: 1.5px solid var(--border);
    }
    .cs-title { font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700; color: var(--text-muted); margin-bottom: 4px; }
    .cs-sub { font-size: 0.83rem; color: var(--purple-light); font-weight: 500; }
    .cs-badge {
      margin-left: auto; background: var(--off-white); border: 1.5px solid var(--border);
      color: var(--text-muted); font-size: 0.72rem; font-weight: 700; padding: 5px 12px;
      border-radius: 999px; flex-shrink: 0; font-family: 'IBM Plex Mono', monospace;
      letter-spacing: 0.05em;
    }

    /* PDF VIEWER MODAL */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(15,10,40,0.85);
      backdrop-filter: blur(8px); z-index: 100; display: flex;
      flex-direction: column; align-items: center; justify-content: center;
      padding: 20px;
    }
    .modal-overlay.hidden { display: none; }
    .modal-top {
      width: 100%; max-width: 900px; display: flex; align-items: center;
      justify-content: space-between; margin-bottom: 12px;
    }
    .modal-title { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 700; color: #fff; }
    .modal-actions { display: flex; gap: 10px; align-items: center; }
    .btn-modal-download {
      background: var(--accent); color: #fff; border: none; padding: 9px 18px;
      border-radius: 999px; font-size: 0.85rem; font-weight: 700; cursor: pointer;
      font-family: inherit; text-decoration: none; display: inline-block;
    }
    .btn-modal-close {
      background: rgba(255,255,255,0.15); border: 1.5px solid rgba(255,255,255,0.3);
      color: #fff; width: 38px; height: 38px; border-radius: 50%; font-size: 1.1rem;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
    }
    .modal-iframe-wrap {
      width: 100%; max-width: 900px; flex: 1; max-height: 80vh;
      border-radius: 16px; overflow: hidden; background: #fff;
    }
    .modal-iframe-wrap iframe { width: 100%; height: 100%; border: none; min-height: 70vh; }


    /* ADD MATERIAL (TEACHER) */
    .add-material-btn { display:none; align-items:center; gap:6px; padding:7px 14px; background:rgba(124,58,237,0.1); border:1.5px solid var(--purple-mid); border-radius:999px; color:var(--purple); font-size:0.78rem; font-weight:700; cursor:pointer; font-family:'IBM Plex Mono',monospace; transition:all 0.15s; flex-shrink:0; }
    .add-material-btn:hover { background:var(--purple-soft); }
    body.teacher-active .add-material-btn { display:flex !important; }

    /* ADD MATERIAL MODAL */
    .am-overlay { position:fixed; inset:0; background:rgba(15,10,40,0.7); backdrop-filter:blur(8px); z-index:200; display:flex; align-items:flex-end; justify-content:center; }
    .am-overlay.hidden { display:none; }
    .am-sheet { background:#fff; border-radius:28px 28px 0 0; width:100%; max-width:540px; padding:0 0 32px; animation:amUp 0.35s cubic-bezier(0.34,1.2,0.64,1); }
    @keyframes amUp { from{transform:translateY(100%);opacity:0} to{transform:translateY(0);opacity:1} }
    .am-handle { width:40px; height:4px; background:var(--border); border-radius:999px; margin:12px auto 0; }
    .am-head { padding:18px 24px 14px; border-bottom:1.5px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
    .am-head-title { font-family:'Playfair Display',serif; font-size:1.05rem; font-weight:800; color:var(--text-dark); }
    .am-close { width:30px; height:30px; border-radius:50%; background:var(--off-white); border:1.5px solid var(--border); color:var(--text-muted); cursor:pointer; font-size:0.9rem; display:flex; align-items:center; justify-content:center; }
    .am-body { padding:20px 24px; display:flex; flex-direction:column; gap:14px; }
    .am-field label { display:block; font-size:0.72rem; font-weight:700; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.08em; margin-bottom:7px; font-family:'IBM Plex Mono',monospace; }
    .am-field input, .am-field select { width:100%; padding:12px 14px; border:1.5px solid var(--border); border-radius:12px; font-family:'IBM Plex Sans',sans-serif; font-size:0.92rem; color:var(--text-dark); background:var(--off-white); outline:none; }
    .am-field input:focus, .am-field select:focus { border-color:var(--purple-light); background:#fff; }
    .am-hint { font-size:0.75rem; color:var(--text-muted); margin-top:5px; line-height:1.4; }
    .am-hint code { background:var(--purple-soft); color:var(--purple); padding:1px 5px; border-radius:4px; font-family:'IBM Plex Mono',monospace; font-size:0.72rem; }
    .am-submit { width:100%; padding:14px; background:linear-gradient(135deg,var(--purple),#5B21B6); color:#fff; font-family:'IBM Plex Sans',sans-serif; font-weight:700; font-size:0.95rem; border:none; border-radius:14px; cursor:pointer; margin-top:4px; }
    .am-submit:hover { opacity:0.9; }
    .am-err { background:#FEE2E2; border:1.5px solid #FCA5A5; border-radius:10px; padding:10px 14px; font-size:0.82rem; color:#991B1B; display:none; }
    .am-err.show { display:block; }

    footer { background: var(--text-dark); color: rgba(255,255,255,0.5); text-align: center; padding: 20px; font-size: 0.85rem; }
    footer strong { color: var(--purple-light); }

    @media (max-width: 600px) {
      .pdf-grid { grid-template-columns: 1fr; }
      .chapter-title { font-size: 1.2rem; }
      .coming-soon-card { flex-wrap: wrap; }
      .cs-badge { margin-left: 0; }
      .modal-title { font-size: 1rem; }
    }
  </style>
<script>
  // Run ASAP before body renders to avoid flash
  if (localStorage.getItem('eq_tu')) {
    document.addEventListener('DOMContentLoaded', function() {
      document.body.classList.add('teacher-active');
      document.querySelectorAll('.add-material-btn').forEach(b => b.style.display = 'flex');
    });
  }
</script>
</head>
<body>

<!-- PDF VIEWER MODAL -->
<div class="modal-overlay hidden" id="pdfModal">
  <div class="modal-top">
    <div class="modal-title" id="modalTitle">Document</div>
    <div class="modal-actions">
      <a class="btn-modal-download" id="modalDownload" href="#" target="_blank">‚¨á Download</a>
      <button class="btn-modal-close" onclick="closeModal()">‚úï</button>
    </div>
  </div>
  <div class="modal-iframe-wrap">
    <iframe id="modalIframe" src="" allowfullscreen></iframe>
  </div>
</div>

<!-- HEADER -->
<header>
  <a class="back-btn" href="index.html">‚Üê Back</a>
  <h1>Lesson <span>Materials</span></h1>
  <p class="header-sub">English Quest ¬∑ SMA Negeri 6 Surakarta</p>
</header>

<svg class="wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 48" preserveAspectRatio="none">
  <path fill="#4C1D95" d="M0,32 C360,0 1080,64 1440,32 L1440,0 L0,0 Z"/>
  <path fill="#F9F7FF" d="M0,48 C360,16 1080,64 1440,32 L1440,48 Z"/>
</svg>

<main>

  <!-- CHAPTER 4 -->
  <div class="chapter-section">
    <div class="chapter-header">
      <div class="chapter-badge">CHAPTER 4</div>
      <div class="chapter-title">Analytical Exposition</div>
      <div class="chapter-line"></div>
      <button class="add-material-btn" onclick="openAddMaterial(4)">Ôºã Add</button>
    </div>
    <div class="pdf-grid" id="grid-ch4">

      <!-- Fact vs Opinion -->
      <div class="pdf-card">
        <div class="pdf-preview">
          <span class="pdf-icon">üìÑ</span>
          <iframe src="https://drive.google.com/file/d/12CCKNiZ2uU9eOmKJ_vxkRGE5rAmAQWRx/preview" title="Fact vs Opinion preview"></iframe>
          <div class="pdf-overlay"><div class="pdf-overlay-btn">üëÅ View</div></div>
        </div>
        <div class="pdf-info">
          <div class="pdf-name">Fact vs Opinion</div>
          <div class="pdf-meta">PDF ¬∑ Chapter 4</div>
          <div class="pdf-actions">
            <button class="btn-view" onclick="openPDF('Fact vs Opinion', 'https://drive.google.com/file/d/12CCKNiZ2uU9eOmKJ_vxkRGE5rAmAQWRx/preview', 'https://drive.google.com/uc?export=download&id=12CCKNiZ2uU9eOmKJ_vxkRGE5rAmAQWRx')">üëÅ View</button>
            <a class="btn-download" href="https://drive.google.com/uc?export=download&id=12CCKNiZ2uU9eOmKJ_vxkRGE5rAmAQWRx" target="_blank">‚¨á</a>
          </div>
        </div>
      </div>

      <!-- Argument -->
      <div class="pdf-card">
        <div class="pdf-preview">
          <span class="pdf-icon">üìÑ</span>
          <iframe src="https://drive.google.com/file/d/1iNKhUJeCStmsQahqrL7lwDBg4Wl72ePQ/preview" title="Argument preview"></iframe>
          <div class="pdf-overlay"><div class="pdf-overlay-btn">üëÅ View</div></div>
        </div>
        <div class="pdf-info">
          <div class="pdf-name">Argument</div>
          <div class="pdf-meta">PDF ¬∑ Chapter 4</div>
          <div class="pdf-actions">
            <button class="btn-view" onclick="openPDF('Argument', 'https://drive.google.com/file/d/1iNKhUJeCStmsQahqrL7lwDBg4Wl72ePQ/preview', 'https://drive.google.com/uc?export=download&id=1iNKhUJeCStmsQahqrL7lwDBg4Wl72ePQ')">üëÅ View</button>
            <a class="btn-download" href="https://drive.google.com/uc?export=download&id=1iNKhUJeCStmsQahqrL7lwDBg4Wl72ePQ" target="_blank">‚¨á</a>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- CHAPTER 5 -->
  <div class="chapter-section">
    <div class="chapter-header">
      <div class="chapter-badge">CHAPTER 5</div>
      <div class="chapter-title">Narrative Text</div>
      <div class="chapter-line"></div>
      <button class="add-material-btn" onclick="openAddMaterial(5)">Ôºã Add</button>
    </div>
    <div class="pdf-grid" id="grid-ch5">
      <div class="coming-soon-card" id="ch5-empty">
        <div class="cs-icon">üìö</div>
        <div>
          <div class="cs-title">Chapter 5 Materials</div>
          <div class="cs-sub">Will be uploaded soon ‚Äî stay tuned!</div>
        </div>
        <div class="cs-badge">COMING SOON</div>
      </div>
    </div>
  </div>

</main>

<footer>¬© 2025 <strong>English Quest</strong> ¬∑ SMA Negeri 6 Surakarta ¬∑ Built with ‚ù§Ô∏è by <strong>LaksMedia</strong></footer>

<script>
  function openPDF(title, previewUrl, downloadUrl) {
    document.getElementById('modalTitle').textContent   = title;
    document.getElementById('modalIframe').src          = previewUrl;
    document.getElementById('modalDownload').href       = downloadUrl;
    document.getElementById('pdfModal').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    document.getElementById('pdfModal').classList.add('hidden');
    document.getElementById('modalIframe').src = '';
    document.body.style.overflow = '';
  }

  // Close on backdrop click
  document.getElementById('pdfModal').addEventListener('click', function(e) {
    if (e.target === this) closeModal();
  });

  // Close on Escape
  document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
</script>

<!-- ADD MATERIAL MODAL -->
<div class="am-overlay hidden" id="amOverlay" onclick="closeAddMaterial(event)">
  <div class="am-sheet">
    <div class="am-handle"></div>
    <div class="am-head">
      <div class="am-head-title" id="amTitle">Add Material ‚Äî Chapter 4</div>
      <button class="am-close" onclick="closeAddMaterial()">‚úï</button>
    </div>
    <div class="am-body">
      <div class="am-field">
        <label>Material Title</label>
        <input type="text" id="amName" placeholder="e.g. Present Perfect Exercise"/>
      </div>
      <div class="am-field">
        <label>Google Drive File ID</label>
        <input type="text" id="amFileId" placeholder="e.g. 1aBcDeFgHiJkLmNoPqRsTuVwXyZ"/>
        <div class="am-hint">
          From the Drive share link:<br/>
          <code>drive.google.com/file/d/<strong>FILE_ID</strong>/view</code><br/>
          Copy only the bold part between <code>/d/</code> and <code>/view</code>
        </div>
      </div>
      <div class="am-field">
        <label>File Type</label>
        <select id="amType">
          <option value="PDF">PDF</option>
          <option value="PPT">PPT / Slides</option>
          <option value="DOC">Word Document</option>
          <option value="IMG">Image</option>
        </select>
      </div>
      <div class="am-err" id="amErr">Please fill in all fields.</div>
      <button class="am-submit" onclick="submitAddMaterial()">Ôºã Add Material</button>
    </div>
  </div>
</div>


<script>
  // Teacher session check
  (function() {
    const u = localStorage.getItem('eq_tu');
    const p = localStorage.getItem('eq_tp');
    if (u && p) {
      document.body.classList.add('teacher-active');
      // Also show buttons directly in case CSS class fails
      document.querySelectorAll('.add-material-btn').forEach(b => b.style.display = 'flex');
    }
  })();

  let amChapter = 4;

  function openAddMaterial(ch) {
    amChapter = ch;
    document.getElementById('amTitle').textContent = 'Add Material ‚Äî Chapter ' + ch;
    document.getElementById('amName').value   = '';
    document.getElementById('amFileId').value = '';
    document.getElementById('amType').value   = 'PDF';
    document.getElementById('amErr').classList.remove('show');
    document.getElementById('amOverlay').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    setTimeout(() => document.getElementById('amName').focus(), 300);
  }

  function closeAddMaterial(e) {
    if (e && e.target !== document.getElementById('amOverlay')) return;
    document.getElementById('amOverlay').classList.add('hidden');
    document.body.style.overflow = '';
  }

  function submitAddMaterial() {
    const name   = document.getElementById('amName').value.trim();
    const fileId = document.getElementById('amFileId').value.trim().replace(/^.*\/d\/([^\/]+).*$/, '$1');
    const type   = document.getElementById('amType').value;
    const err    = document.getElementById('amErr');

    if (!name || !fileId) { err.textContent = 'Please fill in all fields.'; err.classList.add('show'); return; }
    if (fileId.length < 10) { err.textContent = 'That doesn't look like a valid Drive file ID.'; err.classList.add('show'); return; }
    err.classList.remove('show');

    const previewUrl  = 'https://drive.google.com/file/d/' + fileId + '/preview';
    const downloadUrl = 'https://drive.google.com/uc?export=download&id=' + fileId;
    const chLabel     = 'Chapter ' + amChapter;
    const gridId      = 'grid-ch' + amChapter;

    const card = document.createElement('div');
    card.className = 'pdf-card';
    card.innerHTML = \`
      <div class="pdf-preview">
        <span class="pdf-icon">üìÑ</span>
        <iframe src="\${previewUrl}" title="\${name} preview"></iframe>
        <div class="pdf-overlay"><div class="pdf-overlay-btn">üëÅ View</div></div>
      </div>
      <div class="pdf-info">
        <div class="pdf-name">\${name}</div>
        <div class="pdf-meta">\${type} ¬∑ \${chLabel}</div>
        <div class="pdf-actions">
          <button class="btn-view" onclick="openPDF('\${name}', '\${previewUrl}', '\${downloadUrl}')">üëÅ View</button>
          <a class="btn-download" href="\${downloadUrl}" target="_blank">‚¨á</a>
        </div>
      </div>\`;

    // Make card clickable to open PDF
    card.querySelector('.pdf-preview').onclick = () => openPDF(name, previewUrl, downloadUrl);

    // Remove coming soon if present
    const empty = document.getElementById('ch' + amChapter + '-empty');
    if (empty) empty.remove();

    document.getElementById(gridId).appendChild(card);
    closeAddMaterial();

    // Show a quick toast
    showToast('‚úÖ "' + name + '" added to Chapter ' + amChapter + '!');
  }

  // Toast notification
  function showToast(msg) {
    let t = document.getElementById('lsToast');
    if (!t) {
      t = document.createElement('div');
      t.id = 'lsToast';
      t.style.cssText = 'position:fixed;bottom:28px;left:50%;transform:translateX(-50%);background:#1E1040;color:#fff;padding:12px 22px;border-radius:999px;font-size:0.85rem;font-weight:600;z-index:500;opacity:0;transition:opacity 0.3s;white-space:nowrap;';
      document.body.appendChild(t);
    }
    t.textContent = msg;
    t.style.opacity = '1';
    clearTimeout(t._to);
    t._to = setTimeout(() => t.style.opacity = '0', 2800);
  }

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') closeAddMaterial();
  });
</script>

</body>
</html>
